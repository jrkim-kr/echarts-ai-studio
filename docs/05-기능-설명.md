# 기능 상세 설명

## 핵심 기능

### 1. 프롬프트 기반 차트 생성

#### 요구사항 입력

- 차트 유형 지정 (bar, line, pie, scatter, bubble, slope 등)
- 스타일 요구사항 (색상, 레이아웃, 기능 등)
- 자연어로 자유롭게 입력 가능

#### 데이터 입력

- 구조화된 데이터 입력 (엑셀 테이블, CSV 등)
- 자동 데이터 파싱
- 요구사항과 데이터 분리 입력으로 명확한 구분

#### 이미지 업로드

- **스타일 참고 모드**: 이미지의 차트 스타일/유형만 참고, 텍스트 데이터 사용
- **데이터 추출 모드**: "이미지에서 데이터 추출" 키워드 포함 시 이미지에서 실제 데이터 추출
- 이미지 분석을 통한 차트 생성

#### AI 기반 생성

- OpenAI GPT-4o / GPT-4o-mini 연동
- Vision API를 통한 이미지 분석
- 프롬프트 파싱 및 데이터 추출
- 폴백 로직: API 실패 시 로컬 차트 생성 로직 사용

#### JSON 모드

- ECharts JSON 코드 직접 입력
- JavaScript 객체 리터럴 형식 지원
- 함수 호출 자동 제거 (sanitizeForFirebase)
- JSON 파싱 오류 상세 안내

### 2. 차트 시각화

#### ECharts 통합

- Apache ECharts 5.5 사용
- **모든 ECharts 차트 유형 지원**:
  - **Bar Chart** (막대 차트): 카테고리 비교
  - **Line Chart** (선형 차트): 시계열 데이터 추세
  - **Pie Chart** (원형 차트): 비율/퍼센트 표시
  - **Scatter Chart** (산점도): 두 변수 간 관계
  - **Bubble Chart** (버블 차트): 세 변수 관계 (크기 포함)
  - **Slope Chart** (슬로프 차트): 두 값 비교 (일반가/행사가 등)
  - **Radar Chart** (레이더 차트): 다차원 데이터 비교
  - **Sankey Diagram** (상키 다이어그램): 흐름 다이어그램
  - **Funnel Chart** (퍼널 차트): 전환 퍼널 또는 프로세스 흐름
  - **Gauge Chart** (게이지 차트): 단일 값 표시기 (속도계 스타일)
  - **Treemap** (트리맵): 계층적 데이터 시각화
  - **Sunburst** (선버스트): 동심원 계층 구조
  - **Heatmap** (히트맵): 행렬 데이터 시각화
  - **Candlestick** (캔들스틱): 금융 데이터 (OHLC)
  - **Boxplot** (박스플롯): 통계 데이터 분포
  - **Graph** (네트워크 차트): 네트워크 다이어그램 및 관계 그래프
  - **Parallel** (병렬 좌표): 다차원 데이터 병렬 좌표
  - **Tree** (트리 차트): 트리 구조 시각화
  - **Theme River** (테마 리버): 시간에 따른 이벤트 흐름
  - **Map** (지도 차트): 지리적 데이터 시각화
  - **3D Charts** (3D 차트): bar3D, line3D, scatter3D, surface 등

#### 인터랙티브 기능

- 줌 인/아웃 (50% ~ 200%)
- 팬 (드래그)
- 툴팁 (호버 시 상세 정보)
- 범례 클릭 (시리즈 표시/숨김)

#### 반응형 디자인

- 화면 크기에 자동 조정
- 모바일/태블릿/데스크톱 지원
- 차트 높이 동적 조정

#### 이미지 저장

- 고해상도 PNG 다운로드 (pixelRatio: 2)
- 원클릭 다운로드
- 파일명 자동 생성 (타임스탬프 포함)

#### 차트 코드 관리

- 생성된 차트의 JSON 코드 확인
- 코드 복사 기능
- JSON 코드 직접 입력으로 차트 생성

### 3. 차트 개선

#### 자연어 개선

- 기존 차트를 기반으로 자연어로 개선 요청
- 키워드 감지: "추가", "개선", "수정", "변경", "버튼", "기능" 등
- 이전 차트 설정을 컨텍스트로 활용

#### 버전 관리

- 자동 버전 번호 할당 (v1, v2, v3...)
- 프로젝트별 독립적인 버전 관리
- 버전별 차트 추적 및 불러오기

#### 히스토리 관리

- 프로젝트별 차트 생성 히스토리
- 각 버전의 프롬프트 및 생성 시간 기록
- 버전별 차트 삭제 및 자동 재인덱싱

### 4. 프로젝트 관리

#### 프로젝트 생성

- 차트 생성 시 자동 프로젝트 생성
- 수동 프로젝트 생성 가능
- 프로젝트 이름 자동 생성 또는 수동 지정

#### 프로젝트 편집

- 프로젝트 이름 변경 (인라인 편집)
- 프로젝트 삭제
- 프로젝트별 데이터 분리 관리

#### 프로젝트 선택

- 상단 드롭다운으로 프로젝트 선택
- 현재 선택된 차트 버전 표시
- 프로젝트 상세 모달 열기

#### 프로젝트 카드

- 최신 차트 미리보기 (PNG 이미지)
- 프로젝트 정보 표시 (차트 개수, 마지막 업데이트)
- 빠른 접근 및 편집 기능

### 5. 데이터 저장 및 관리

#### Firebase Realtime Database

- 실시간 데이터 동기화
- 프로젝트별 데이터 분리
- 자동 저장 (차트 생성 시)
- 오프라인 지원

#### 로컬 스토리지

- 현재 작업 세션 저장
- 페이지 새로고침 시 복원
- 현재 프로젝트 ID 저장

#### 세션 스토리지

- 임시 상태 관리
- Firebase 경고 메시지 제어

### 6. 사용자 인터페이스

#### 레이아웃

- **좌우 분할 레이아웃**: 프롬프트 입력(왼쪽)과 차트 표시(오른쪽)
- **고정 높이**: 각 섹션 70vh 고정
- **Sticky 헤더**: 프로젝트 선택기 고정
- **반응형**: 모바일에서는 세로 배치

#### 디자인

- Toss 스타일의 깔끔한 디자인
- 일관된 색상 팔레트 (파란색 계열)
- 부드러운 애니메이션 및 전환 효과
- 명확한 시각적 계층 구조

#### 컴포넌트

- **프롬프트 입력**: 요구사항/데이터 분리 입력, 이미지 업로드, 인라인 전송 버튼
- **차트 표시**: 확대/축소 컨트롤, 이미지 저장 버튼, 버전 표시
- **프로젝트 카드**: 차트 미리보기, 이름 편집, 삭제 메뉴
- **프로젝트 상세 모달**: 차트 히스토리, 버전별 불러오기, 삭제
- **토스트 알림**: 성공/오류 피드백

## 기술적 특징

### 성능 최적화

- 코드 분할 (Next.js 자동)
- 지연 로딩 (프로젝트 차트 목록)
- 메모이제이션 (필요 시)
- ECharts 인스턴스 최적화

### 에러 처리

- API 오류 시 폴백 로직
- 사용자 친화적 오류 메시지
- Firebase 연결 오류 처리
- 입력 검증

### 보안

- 환경 변수를 통한 API 키 관리
- Firebase 보안 규칙
- 입력 데이터 검증
- 민감 정보 노출 방지

## 사용 시나리오

### 시나리오 1: 기본 차트 생성

1. 새 프로젝트 시작
2. 요구사항 입력: "제조사별 판매량을 바 차트로 만들어줘"
3. 데이터 입력: "스타벅스: 100, 네스프레소: 200, 카누: 150"
4. 생성 버튼 클릭
5. 차트 자동 생성 및 저장

### 시나리오 2: 차트 개선

1. 기존 프로젝트 선택
2. 요구사항 입력: "차트에 범례 추가해줘"
3. 생성 버튼 클릭
4. 기존 차트를 기반으로 개선된 차트 생성 (v2)

### 시나리오 3: 이미지 스타일 참고

1. 참고할 차트 이미지 업로드
2. 요구사항과 데이터 입력
3. 생성 버튼 클릭
4. 이미지 스타일을 참고하여 유사한 형태로 차트 생성

### 시나리오 4: 이미지 데이터 추출

1. 데이터가 포함된 차트 이미지 업로드
2. 요구사항 입력: "이미지에서 데이터를 추출해서 차트 만들어줘"
3. 생성 버튼 클릭
4. 이미지에서 데이터 추출 후 차트 생성

### 시나리오 5: JSON 코드 직접 입력

1. "JSON 코드 입력" 버튼 클릭
2. ECharts 옵션 JSON 코드 입력
3. "적용" 버튼 클릭
4. JSON 코드로부터 직접 차트 생성 (프롬프트 무시)

### 시나리오 6: 차트 코드 확인 및 복사

1. 생성된 차트에서 "코드 보기" 버튼 클릭
2. JSON 코드 모달에서 코드 확인
3. "복사" 버튼으로 코드 복사
4. 다른 프로젝트에서 재사용 가능

## 향후 개선 계획

- [ ] 더 많은 차트 유형 지원
- [ ] 차트 템플릿 라이브러리
- [ ] 데이터 소스 연동 (Google Sheets, CSV 파일 등)
- [ ] 협업 기능 (프로젝트 공유)
- [ ] 차트 애니메이션 커스터마이징
- [ ] 다국어 지원
