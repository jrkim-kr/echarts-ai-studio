# 🔑 환경 변수 설정 가이드

이 문서는 `.env.local.example` 파일에 있는 모든 환경 변수 값을 실제로 가져오고 설정하는 방법을 단계별로 설명합니다.

## 📋 목차

1. [Firebase 설정 값 가져오기](#1-firebase-설정-값-가져오기)
2. [OpenAI API 키 가져오기](#2-openai-api-키-가져오기)
3. [환경 변수 파일 생성 및 입력](#3-환경-변수-파일-생성-및-입력)
4. [설정 확인](#4-설정-확인)

---

## 1. Firebase 설정 값 가져오기

`.env.local.example` 파일의 1-8번째 줄에 있는 Firebase 관련 변수들을 가져오는 방법입니다.

### 1.1 Firebase 프로젝트 생성 (아직 없다면)

1. 웹 브라우저에서 [Firebase Console](https://console.firebase.google.com/) 접속
2. Google 계정으로 로그인
3. **"프로젝트 추가"** 또는 **"Add project"** 클릭
4. 프로젝트 이름 입력 (예: `echarts-ai-studio`)
5. **"계속"** 클릭
6. Google Analytics 설정 체크 안 함
7. **"프로젝트 만들기"** 클릭
8. 프로젝트 생성 완료까지 대기 (약 30초)

### 1.2 Realtime Database 활성화

1. Firebase Console 왼쪽 메뉴에서 **"빌드"** → **"Realtime Database"** 클릭
2. **"데이터베이스 만들기"** 클릭
3. 보안 규칙 선택:
   - **"테스트 모드에서 시작"** 선택 (개발용)
4. 위치 선택:
   - 한국: **"asia-northeast3 (Seoul)"** 권장
5. **"완료"** 클릭

### 1.3 Firebase 설정 정보 가져오기

이 단계에서 `.env.local.example` 파일의 모든 Firebase 변수 값을 가져올 수 있습니다.

#### 단계 1: 프로젝트 설정 페이지 접속

1. Firebase Console 왼쪽 상단의 **⚙️ 설정 아이콘** 클릭
2. **"프로젝트 설정"** 또는 **"Project settings"** 클릭

#### 단계 2: 웹 앱 추가 (아직 없다면)

1. 페이지를 아래로 스크롤하여 **"내 앱"** 또는 **"Your apps"** 섹션 찾기
2. **"</>"** (웹 아이콘) 버튼 클릭
3. 앱 닉네임 입력 (예: `ECharts AI Studio`)
4. **"Firebase Hosting도 설정"** 체크박스는 선택하지 않음
5. **"앱 등록"** 또는 **"Register app"** 클릭

#### 단계 3: 설정 정보 확인 및 복사

다음과 같은 코드 블록이 표시됩니다:

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "echarts-ai-studio.firebaseapp.com",
  databaseURL: "https://echarts-ai-studio-default-rtdb.firebaseio.com",
  projectId: "echarts-ai-studio",
  storageBucket: "echarts-ai-studio.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdef1234567890",
};
```

이 정보를 복사해두세요!

#### 단계 4: 각 값 매핑하기

Firebase 설정 코드의 각 값을 `.env.local.example` 파일의 변수명에 매핑합니다:

| `.env.local.example` 변수명                | Firebase 코드 속성  | 복사할 값 예시                                          |
| ------------------------------------------ | ------------------- | ------------------------------------------------------- |
| `NEXT_PUBLIC_FIREBASE_API_KEY`             | `apiKey`            | `AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX`                   |
| `NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN`         | `authDomain`        | `echarts-ai-studio.firebaseapp.com`                     |
| `NEXT_PUBLIC_FIREBASE_DATABASE_URL`        | `databaseURL`       | `https://echarts-ai-studio-default-rtdb.firebaseio.com` |
| `NEXT_PUBLIC_FIREBASE_PROJECT_ID`          | `projectId`         | `echarts-ai-studio`                                     |
| `NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET`      | `storageBucket`     | `echarts-ai-studio.appspot.com`                         |
| `NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID` | `messagingSenderId` | `123456789012`                                          |
| `NEXT_PUBLIC_FIREBASE_APP_ID`              | `appId`             | `1:123456789012:web:abcdef1234567890`                   |

**💡 팁**:

- `databaseURL`은 Realtime Database를 생성한 후에만 표시됩니다
- 값에 따옴표(`"`)가 포함되어 있으면 제거하고 복사하세요
- 모든 값은 정확히 복사해야 합니다 (공백 주의)

---

## 2. OpenAI API 키 가져오기

`.env.local.example` 파일의 12번째 줄에 있는 `OPENAI_API_KEY` 값을 가져오는 방법입니다.

### 2.1 OpenAI 계정 생성

1. [OpenAI 웹사이트](https://platform.openai.com/) 접속
2. **"Sign up"** 버튼 클릭하여 계정 생성
3. 이메일 인증 완료

### 2.2 API 키 발급

1. 로그인 후 [API Keys 페이지](https://platform.openai.com/api-keys)로 이동
2. 우측 상단의 **"Create new secret key"** 버튼 클릭
3. 키 이름 입력 (예: "ECharts AI Studio")
4. **"Create secret key"** 클릭
5. **⚠️ 중요**: 생성된 API 키를 즉시 복사해두세요. 다시 볼 수 없습니다!
   - 형식: `sk-...` (약 51자)

### 2.3 예산 설정 (중요!)

⚠️ **OpenAI API를 사용하려면 반드시 예산(Spending Limit)을 설정해야 합니다!**

1. [Billing 페이지](https://platform.openai.com/account/billing) 접속
2. 좌측 메뉴에서 **"Usage limits"** 또는 **"Spending limits"** 클릭
3. **"Hard limit"** 또는 **"Spending limit"** 섹션에서 원하는 금액 입력
   - 예: `$5`, `$10`, `$20` 등
   - **최소 $5 이상 권장** (테스트용)
4. **"Save"** 또는 **"Update"** 버튼 클릭

**💡 참고**:

- 신규 계정에는 $5 크레딧이 제공되지만, 예산을 설정하지 않으면 API를 사용할 수 없습니다
- 예산이 $0으로 설정되어 있으면 API 호출이 차단됩니다

---

## 3. 환경 변수 파일 생성 및 입력

이제 가져온 값들을 `.env.local` 파일에 입력합니다.

### 3.1 .env.local 파일 생성

프로젝트 루트 디렉토리(`/Users/jrkim/Projects/echarts-ai-studio/`)에 `.env.local` 파일을 생성합니다.

**방법 1: 터미널 사용**

```bash
cd /Users/jrkim/Projects/echarts-ai-studio
touch .env.local
```

**방법 2: VS Code 사용**

1. VS Code에서 프로젝트 폴더 열기
2. 파일 탐색기에서 우클릭 → **"New File"** 클릭
3. 파일 이름을 `.env.local`로 입력

**방법 3: Finder 사용 (Mac)**

1. Finder에서 프로젝트 폴더 열기
2. `Cmd + Shift + .` (점)을 눌러 숨김 파일 표시
3. 빈 공간에서 우클릭 → **"새 문서 만들기"** → **"텍스트 문서"**
4. 파일 이름을 `.env.local`로 변경

### 3.2 환경 변수 입력

생성한 `.env.local` 파일을 텍스트 에디터로 열고, 다음 형식으로 입력합니다:

```env
# Firebase 설정
NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=echarts-ai-studio.firebaseapp.com
NEXT_PUBLIC_FIREBASE_DATABASE_URL=https://echarts-ai-studio-default-rtdb.firebaseio.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=echarts-ai-studio
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=echarts-ai-studio.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789012
NEXT_PUBLIC_FIREBASE_APP_ID=1:123456789012:web:abcdef1234567890

# LLM API 설정
OPENAI_API_KEY=sk-your-openai-api-key-here
```

**⚠️ 중요 사항:**

1. **실제 값으로 대체**: 위의 예시 값들을 Firebase Console과 OpenAI에서 복사한 실제 값으로 대체하세요
2. **따옴표 없이 입력**: 값에 따옴표(`"`)를 포함하지 마세요
3. **공백 주의**: `=` 앞뒤에 공백이 없어야 합니다
4. **주석 유지**: `#`로 시작하는 주석은 그대로 두어도 됩니다
5. **모든 변수 필수**: Firebase 관련 변수는 모두 필수입니다 (OpenAI API 키는 선택사항)

### 3.3 파일 저장

파일을 저장합니다 (`Cmd + S` 또는 `Ctrl + S`)

---

## 4. 설정 확인

### 4.1 개발 서버 재시작

환경 변수를 변경한 후에는 반드시 개발 서버를 재시작해야 합니다:

```bash
# 개발 서버가 실행 중이면 중지 (Ctrl + C)
# 그 다음 다시 시작
cd /Users/jrkim/Projects/echarts-ai-studio
npm run dev
```

### 4.2 브라우저에서 확인

1. 브라우저에서 [http://localhost:3000](http://localhost:3000) 접속
2. 페이지가 정상적으로 로드되는지 확인
3. 브라우저 개발자 도구 열기 (`F12` 또는 `Cmd + Option + I`)
4. **Console** 탭에서 오류가 없는지 확인

### 4.3 Firebase 연결 테스트

1. 프롬프트 입력창에 아무 텍스트나 입력 (예: "테스트 차트")
2. **"차트 생성하기"** 버튼 클릭
3. 차트가 생성되는지 확인
4. Firebase Console에서 Realtime Database 확인:
   - Firebase Console → Realtime Database → **"데이터"** 탭
   - 데이터가 저장되었는지 확인

### 4.4 OpenAI API 테스트 (선택사항)

1. 프롬프트 입력창에 자연어로 차트 요청 입력 (예: "2024년 월별 매출을 막대 그래프로 보여줘")
2. **"차트 생성하기"** 버튼 클릭
3. AI가 차트를 생성하는지 확인
4. 브라우저 개발자 도구 Console에서 오류 확인

---

## 🔧 문제 해결

### 문제 1: 환경 변수가 undefined로 표시됨

**원인:**

- `NEXT_PUBLIC_` 접두사 누락
- 개발 서버를 재시작하지 않음
- 파일 이름이 잘못됨 (`.env.local`이어야 함)

**해결:**

1. 모든 Firebase 변수에 `NEXT_PUBLIC_` 접두사 확인
2. 개발 서버 완전히 종료 후 재시작
3. 파일 이름이 정확히 `.env.local`인지 확인

### 문제 2: Firebase 연결 오류

**원인:**

- API 키가 잘못됨
- Database URL이 잘못됨
- 보안 규칙이 잘못 설정됨

**해결:**

1. Firebase Console에서 설정 정보 다시 확인
2. `.env.local` 파일의 값이 정확한지 확인 (공백, 따옴표 확인)
3. Realtime Database 보안 규칙 확인

### 문제 3: OpenAI API 오류

**원인:**

- API 키가 잘못됨
- 예산이 설정되지 않음
- 크레딧이 부족함

**해결:**

1. OpenAI API Keys 페이지에서 키 확인
2. Billing 페이지에서 예산 설정 확인
3. Usage 페이지에서 사용량 및 크레딧 확인

### 문제 4: Permission denied 오류

**원인:**

- Firebase 보안 규칙이 너무 엄격함
- 데이터베이스 경로가 잘못됨

**해결:**

1. Firebase Console → Realtime Database → **"규칙"** 탭 확인
2. 개발용 보안 규칙 적용:
   ```json
   {
     "rules": {
       "projects": {
         ".read": true,
         ".write": true
       }
     }
   }
   ```
3. **"게시"** 버튼 클릭

---

## 📝 체크리스트

설정이 완료되었는지 확인하세요:

### Firebase 설정

- [ ] Firebase 프로젝트 생성 완료
- [ ] Realtime Database 활성화 완료
- [ ] 웹 앱 추가 완료
- [ ] Firebase 설정 정보 복사 완료
- [ ] `NEXT_PUBLIC_FIREBASE_API_KEY` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_DATABASE_URL` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_PROJECT_ID` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID` 입력 완료
- [ ] `NEXT_PUBLIC_FIREBASE_APP_ID` 입력 완료

### OpenAI API 설정 (선택사항)

- [ ] OpenAI 계정 생성 완료
- [ ] API 키 발급 완료
- [ ] 예산 설정 완료
- [ ] `OPENAI_API_KEY` 입력 완료

### 최종 확인

- [ ] `.env.local` 파일 생성 완료
- [ ] 모든 환경 변수 입력 완료
- [ ] 개발 서버 재시작 완료
- [ ] 브라우저에서 테스트 완료
- [ ] Firebase에 데이터 저장 확인 완료

---

## 📚 관련 문서

더 자세한 정보는 다음 문서를 참고하세요:

- **Firebase 설정 상세 가이드**: [`03-Firebase-설정-가이드.md`](./03-Firebase-설정-가이드.md)
- **OpenAI API 설정 상세 가이드**: [`04-OpenAI-API-설정-가이드.md`](./04-OpenAI-API-설정-가이드.md)
- **빠른 시작 가이드**: [`01-빠른-시작.md`](./01-빠른-시작.md)

---

## 🎉 완료!

모든 환경 변수를 성공적으로 설정했습니다. 이제 프로젝트를 사용할 준비가 되었습니다!

**다음 단계:**

1. 차트 생성 테스트
2. 프로젝트 관리 기능 사용
3. Vercel에 배포 (환경 변수도 Vercel에 설정 필요)
